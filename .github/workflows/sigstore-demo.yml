on:
    workflow_dispatch:
    push:
        branches:
            -main
jobs:
  sign_local_object_keylessly_with_cosign:
    runs-on: ubuntu-latest

    permissions: 
        contents: write 
        id-token: write

    name: Install Cosign and test presence in path
    steps:
      - name: Checkout 
        uses: actions/checkout@v3
      - name: Install Cosign
        uses: sigstore/cosign-installer@main
        with:
          cosign-release: 'v2.0.0-rc.0'
      - name: Sign with Github Identity 
        run: cosign sign-blob --yes --bundle verification.json README.md
      - name: Create a Release for Verification 
        uses: ncipollo/release-action@v1
        with:
          artifacts: "README.md,verification.json"
          tag: {{ $GITHUB_JOB }}
          body: "verify the signature of the README.md file using ```cosign verify-blob --bundle verification.json https://{{ $GITHUB_WORKFLOW_REF }} --certificate-oidc-issuer https://token.actions.githubusercontent.com README.md```. "


